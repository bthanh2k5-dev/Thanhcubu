<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Nông Trại</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#cce7a1; display:flex; justify-content:center; }
.map-container { position: relative; width: 100%; max-width: 800px; margin:20px auto; border:2px solid #333; }
.map-container img.map { width:100%; display:block; }
.popup { display:none; position: fixed; top:50%; left:50%; transform: translate(-50%, -50%);
        background: #fff; border: 2px solid #333; border-radius:10px; padding:20px; z-index:1000; width:300px;
        box-shadow:0 0 10px rgba(0,0,0,0.5);}
.popup h2 { text-align:center; margin-bottom:10px; }
.popup button.close-btn { display:block; margin:10px auto 0; padding:5px 15px; background:#f44336; color:#fff; border:none; border-radius:5px; cursor:pointer;}
.overlay {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); z-index:900;}
</style>
</head>
<body>

<div class="map-container" id="mapContainer">
    <img src="https://raw.githubusercontent.com/bthanh2k5-dev/Thanhcubu/main/Map1.jpg" class="map" id="map">
</div>

<div class="overlay" id="overlay"></div>
<div class="popup" id="popup">
    <h2>Kho đồ</h2>
    <p>Đây là kho đồ của bạn. Thêm item ở đây.</p>
    <button class="close-btn" id="closePopup">Đóng</button>
</div>

<script>
const mapContainer = document.getElementById('mapContainer');
const map = document.getElementById('map');
const overlay = document.getElementById('overlay');
const popup = document.getElementById('popup');
const closeBtn = document.getElementById('closePopup');

// Các item với tọa độ x,y (map gốc 800x600) và kích thước vùng click
const items = [
    {id:'house', src:'https://raw.githubusercontent.com/bthanh2k5-dev/Thanhcubu/main/main%20house.png', x:200, y:40, width:300, height:100, clickable:true}
    // thêm item khác ở đây {id:'tree1', src:'tree.png', x:100, y:200, width:80, height:80, clickable:false}
];

// Vẽ item lên map
function drawItems() {
    const scaleX = map.offsetWidth / 800; // scale theo map gốc
    const scaleY = map.offsetHeight / 600;

    items.forEach(item=>{
        let img = document.getElementById(item.id);
        if(!img){
            img = document.createElement('img');
            img.id = item.id;
            img.src = item.src;
            img.classList.add('item');
            mapContainer.appendChild(img);
        }
        img.style.position = 'absolute';
        img.style.width = item.width * scaleX + 'px';
        img.style.left = item.x * scaleX + 'px';
        img.style.top = item.y * scaleY + 'px';
        img.style.cursor = item.clickable ? 'pointer' : 'default';
    });
}

// Click detection
mapContainer.addEventListener('click', function(e){
    const rect = mapContainer.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const clickY = e.clientY - rect.top;
    const scaleX = map.offsetWidth / 800;
    const scaleY = map.offsetHeight / 600;

    items.forEach(item=>{
        if(item.clickable){
            const itemX = item.x * scaleX;
            const itemY = item.y * scaleY;
            const itemW = item.width * scaleX;
            const itemH = item.height * scaleY;
            if(clickX>=itemX && clickX<=itemX+itemW && clickY>=itemY && clickY<=itemY+itemH){
                popup.style.display='block';
                overlay.style.display='block';
            }
        }
    });
});

// Đóng popup
closeBtn.addEventListener('click', ()=>{popup.style.display='none'; overlay.style.display='none';});
overlay.addEventListener('click', ()=>{popup.style.display='none'; overlay.style.display='none';});

// Vẽ item khi load và khi resize
window.addEventListener('load', drawItems);
window.addEventListener('resize', drawItems);

</script>
</body>
</html>
